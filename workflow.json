{
  "name": "My workflow",
  "nodes": [
    {
      "parameters": {
        "rule": {
          "interval": [
            {
              "field": "seconds"
            }
          ]
        }
      },
      "type": "n8n-nodes-base.scheduleTrigger",
      "typeVersion": 1.3,
      "position": [
        10752,
        4608
      ],
      "id": "1dfb08a2-6e6a-4695-acc8-a83b8eba2928",
      "name": "Schedule Trigger"
    },
    {
      "parameters": {
        "url": "=https://api.telegram.org/bot8258494682:AAGvKOZciWqugNFLEcHb8gPXxl18U7ZAR_0/getUpdates",
        "sendQuery": true,
        "queryParameters": {
          "parameters": [
            {
              "name": "offset",
              "value": "={{ $vars.telegramOffset || 0 }}"
            }
          ]
        },
        "options": {
          "timeout": 30000
        }
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.3,
      "position": [
        10960,
        4608
      ],
      "id": "db09afc3-824e-48d1-b957-ed743196768d",
      "name": "HTTP Request"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 3
          },
          "conditions": [
            {
              "id": "b115accf-1de2-49c8-a037-98786d5077b6",
              "leftValue": "={{ $json['result'].length > 0 }}",
              "rightValue": "",
              "operator": {
                "type": "boolean",
                "operation": "true",
                "singleValue": true
              }
            },
            {
              "id": "c8694386-9eab-4f5a-a341-2980f46176a2",
              "leftValue": "={{ $json['result'][0].update_id > 0 }}",
              "rightValue": "",
              "operator": {
                "type": "boolean",
                "operation": "true",
                "singleValue": true
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.3,
      "position": [
        11136,
        4608
      ],
      "id": "33dbcf58-43a4-4ebf-9395-1bec180aab98",
      "name": "If"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "ab010354-d991-4a82-8d1c-5da762bc9f2f",
              "name": "=N8N_TELEGRAM_LAST_UPDATE_ID",
              "value": "={{ $json['result'][0].update_id }}",
              "type": "string"
            },
            {
              "id": "e25ee29e-57a8-42e3-bc44-f4b52bd2af22",
              "name": "telegram_data",
              "value": "={{ $json }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        11552,
        4592
      ],
      "id": "598764e6-8134-4a2f-b391-fd0740dcb299",
      "name": "Edit Fields"
    },
    {
      "parameters": {
        "rules": {
          "values": [
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 3
                },
                "conditions": [
                  {
                    "id": "051aaead-bede-48fe-a989-01cb6d35e49b",
                    "leftValue": "={{ $json.contentType }}",
                    "rightValue": "video",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 3
                },
                "conditions": [
                  {
                    "id": "ce7ec8ba-2415-49b9-8f2c-3d51c4aaf026",
                    "leftValue": "={{ $json.contentType }}",
                    "rightValue": "url",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.switch",
      "typeVersion": 3.4,
      "position": [
        11872,
        4528
      ],
      "id": "378bc901-303f-42fa-ad60-0d42e6f3f049",
      "name": "Switch"
    },
    {
      "parameters": {
        "jsCode": "// –ö–û–î –° –ü–†–ê–í–ò–õ–¨–ù–û–ô –û–ë–†–ê–ë–û–¢–ö–û–ô JSON –°–¢–†–û–ö–ò (–î–û–ü–û–õ–ù–ï–ù –î–õ–Ø VIDEO)\ntry {\n  console.log('=== –ù–ê–ß–ê–õ–û –û–ë–†–ê–ë–û–¢–ö–ò ===');\n  \n  // –ü–æ–ª—É—á–∞–µ–º –≤—Å–µ —ç–ª–µ–º–µ–Ω—Ç—ã\n  const allItems = $input.all();\n  console.log('–í—Å–µ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–æ–≤:', allItems.length);\n  \n  // –ò—â–µ–º —ç–ª–µ–º–µ–Ω—Ç —Å telegram_data\n  let telegramDataString = null;\n  \n  for (const item of allItems) {\n    if (item.json && item.json.telegram_data) {\n      telegramDataString = item.json.telegram_data;\n      console.log('‚úÖ –ù–∞–π–¥–µ–Ω telegram_data (—Ç–∏–ø:', typeof telegramDataString, ')');\n      break;\n    }\n  }\n  \n  if (!telegramDataString) {\n    console.log('‚ùå –ù–µ –Ω–∞–π–¥–µ–Ω telegram_data');\n    return [];\n  }\n  \n  // –ü–ê–†–°–ò–ú JSON —Å—Ç—Ä–æ–∫—É –≤ –æ–±—ä–µ–∫—Ç\n  let telegramData;\n  try {\n    telegramData = JSON.parse(telegramDataString);\n    console.log('‚úÖ JSON —É—Å–ø–µ—à–Ω–æ —Ä–∞—Å–ø–∞—Ä—Å–µ–Ω');\n  } catch (parseError) {\n    console.error('‚ùå –û—à–∏–±–∫–∞ –ø–∞—Ä—Å–∏–Ω–≥–∞ JSON:', parseError.message);\n    console.log('–°—Ç—Ä–æ–∫–∞ –¥–ª—è –ø–∞—Ä—Å–∏–Ω–≥–∞:', telegramDataString.substring(0, 100) + '...');\n    return [];\n  }\n  \n  // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—Ç—Ä—É–∫—Ç—É—Ä—É\n  if (!telegramData.result || !Array.isArray(telegramData.result) || telegramData.result.length === 0) {\n    console.log('‚ùå –ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –≤ result');\n    return [];\n  }\n  \n  const firstResult = telegramData.result[0];\n  \n  if (!firstResult.message) {\n    console.log('‚ùå –ù–µ—Ç message –≤ result[0]');\n    return [];\n  }\n  \n  const message = firstResult.message;\n  console.log('‚úÖ –°–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç:', message.from.first_name);\n  \n  // –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Ç–∏–ø –∫–æ–Ω—Ç–µ–Ω—Ç–∞ –∏ –¥–∞–Ω–Ω—ã–µ\n  let contentType = 'text';\n  let contentData = '';\n  let isUrl = false;\n  let videoInfo = null;\n  \n  // –û–ë–†–ê–ë–û–¢–ö–ê –í–ò–î–ï–û\n  // –û–ë–†–ê–ë–û–¢–ö–ê –í–ò–î–ï–û\nif (message.video) {\n  contentType = 'video';\n  contentData = message.video.file_id; // file_id –¥–ª—è —Å–∫–∞—á–∏–≤–∞–Ω–∏—è —á–µ—Ä–µ–∑ getFile\n  \n  // ‚≠ê –°–û–•–†–ê–ù–Ø–ï–ú –í–°–ï ID –î–õ–Ø –†–ê–ë–û–¢–´ –° –í–ò–î–ï–û\n  videoInfo = {\n    // –û–°–ù–û–í–ù–´–ï ID –î–õ–Ø API TELEGRAM\n    fileId: message.video.file_id,           // –î–ª—è getFile –∏ —Å–∫–∞—á–∏–≤–∞–Ω–∏—è\n    fileUniqueId: message.video.file_unique_id, // –£–Ω–∏–∫–∞–ª—å–Ω—ã–π ID —Ñ–∞–π–ª–∞\n    thumbnailFileId: message.video.thumbnail?.file_id || null, // ID –ø—Ä–µ–≤—å—é\n    \n    // –ú–ï–¢–ê–î–ê–ù–ù–´–ï –í–ò–î–ï–û\n    duration: message.video.duration,\n    width: message.video.width,\n    height: message.video.height,\n    fileSize: message.video.file_size,\n    fileName: message.video.file_name || '',\n    mimeType: message.video.mime_type || 'video/mp4',\n    \n    // –ò–ù–§–û–†–ú–ê–¶–ò–Ø –û –ü–†–ï–í–¨–Æ (thumbnail)\n    thumbnail: message.video.thumbnail ? {\n      fileId: message.video.thumbnail.file_id,\n      fileUniqueId: message.video.thumbnail.file_unique_id,\n      fileSize: message.video.thumbnail.file_size,\n      width: message.video.thumbnail.width,\n      height: message.video.thumbnail.height\n    } : null,\n    \n    // –ü–û–î–ü–ò–°–¨\n    caption: message.caption || '',\n    hasCaption: !!message.caption,\n    \n    // –¢–ï–•–ù–ò–ß–ï–°–ö–ê–Ø –ò–ù–§–û–†–ú–ê–¶–ò–Ø\n    fileType: 'video',\n    canBeDownloaded: true,\n    \n    // –°–°–´–õ–ö–ò –î–õ–Ø –ü–û–õ–£–ß–ï–ù–ò–Ø –§–ê–ô–õ–ê (—Ñ–æ—Ä–º–∏—Ä—É—é—Ç—Å—è)\n    getFileUrl: `https://api.telegram.org/bot{BOT_TOKEN}/getFile?file_id=${message.video.file_id}`,\n    downloadUrl: `https://api.telegram.org/file/bot{BOT_TOKEN}/{file_path}`\n  };\n  \n  console.log('üé¨ –í–∏–¥–µ–æ —Å–æ–æ–±—â–µ–Ω–∏–µ:');\n  console.log('   üìÅ File ID:', videoInfo.fileId.substring(0, 30) + '...');\n  console.log('   üÜî Unique ID:', videoInfo.fileUniqueId);\n  console.log('   üìè –†–∞–∑—Ä–µ—à–µ–Ω–∏–µ:', videoInfo.width + 'x' + videoInfo.height);\n  console.log('   ‚è±Ô∏è –î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:', videoInfo.duration + '—Å–µ–∫');\n  console.log('   üíæ –†–∞–∑–º–µ—Ä:', videoInfo.fileSize ? \n    Math.round(videoInfo.fileSize / 1024 / 1024 * 100) / 100 + 'MB' : '–Ω–µ–∏–∑–≤–µ—Å—Ç–Ω–æ');\n  console.log('   üñºÔ∏è –ü—Ä–µ–≤—å—é:', videoInfo.thumbnail ? \n    `${videoInfo.thumbnail.width}x${videoInfo.thumbnail.height}` : '–Ω–µ—Ç');\n  console.log('   üìù –ü–æ–¥–ø–∏—Å—å:', videoInfo.caption || '(–Ω–µ—Ç –ø–æ–¥–ø–∏—Å–∏)');\n}\n  // –û–ë–†–ê–ë–û–¢–ö–ê –¢–ï–ö–°–¢–ê (–æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–∞—è –ª–æ–≥–∏–∫–∞)\n  else if (message.text) {\n    contentData = message.text;\n    console.log('‚úÖ –¢–µ–∫—Å—Ç:', message.text.substring(0, 60) + '...');\n    \n    // –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ URL (–æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–∞—è –ª–æ–≥–∏–∫–∞)\n    const urlRegex = /(https?:\\/\\/[^\\s]+)/g;\n    const urls = message.text.match(urlRegex);\n    if (urls && urls.length > 0) {\n      contentType = 'url';\n      isUrl = true;\n      console.log('üîó –û–±–Ω–∞—Ä—É–∂–µ–Ω–∞ —Å—Å—ã–ª–∫–∞');\n    }\n  }\n  // –ï–°–õ–ò –ù–ò –í–ò–î–ï–û, –ù–ò –¢–ï–ö–°–¢ - –ü–†–û–ë–£–ï–ú –î–†–£–ì–ò–ï –¢–ò–ü–´\n  else if (message.caption) {\n    // –ï—Å–ª–∏ –µ—Å—Ç—å —Ç–æ–ª—å–∫–æ –ø–æ–¥–ø–∏—Å—å (–Ω–∞–ø—Ä–∏–º–µ—Ä, —É —Ñ–æ—Ç–æ –±–µ–∑ —Ç–µ–∫—Å—Ç–∞)\n    contentType = 'caption';\n    contentData = message.caption;\n    console.log('üìù –¢–æ–ª—å–∫–æ –ø–æ–¥–ø–∏—Å—å:', message.caption.substring(0, 60) + '...');\n  }\n  else {\n    console.log('‚ö†Ô∏è –ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π —Ç–∏–ø —Å–æ–æ–±—â–µ–Ω–∏—è. –î–æ—Å—Ç—É–ø–Ω—ã–µ –ø–æ–ª—è:', Object.keys(message));\n    // –ú–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É –¥—Ä—É–≥–∏—Ö —Ç–∏–ø–æ–≤ –ø–æ –∞–Ω–∞–ª–æ–≥–∏–∏\n    return [];\n  }\n  \n  // –§–æ—Ä–º–∏—Ä—É–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç (—Å–æ—Ö—Ä–∞–Ω—è—è –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É + –¥–æ–±–∞–≤–ª—è–µ–º videoInfo –µ—Å–ª–∏ –µ—Å—Ç—å)\n  const result = {\n    json: {\n      // –û—Å–Ω–æ–≤–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ\n      chatId: message.chat.id,\n      messageId: message.message_id,\n      updateId: firstResult.update_id,\n      \n      // –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ\n      userId: message.from.id,\n      username: message.from.username || '',\n      firstName: message.from.first_name,\n      lastName: message.from.last_name || '',\n      \n      // –ö–æ–Ω—Ç–µ–Ω—Ç\n      contentType: contentType,\n      contentData: contentData,\n      text: message.text || message.caption || contentData, // –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ç–µ–∫—Å—Ç –∏–ª–∏ –ø–æ–¥–ø–∏—Å—å\n      isUrl: isUrl,\n      \n      // –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –≤–∏–¥–µ–æ (–µ—Å–ª–∏ –µ—Å—Ç—å)\n      videoInfo: videoInfo,\n      \n      // –¢–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ\n      timestamp: message.date,\n      success: true,\n      processedAt: new Date().toISOString()\n    }\n  };\n  \n  console.log('‚úÖ –û–±—Ä–∞–±–æ—Ç–∞–Ω–æ –∫–∞–∫:', contentType.toUpperCase());\n  return [result];\n  \n} catch (error) {\n  console.error('üí• –û—à–∏–±–∫–∞ –≤ Code node:', error.message);\n  console.error('Stack:', error.stack);\n  return [];\n}"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        11696,
        4592
      ],
      "id": "6d644873-4d55-4744-93a4-3a0d73d1324c",
      "name": "Code in JavaScript"
    },
    {
      "parameters": {
        "url": "={{ $json.videoUrl }}",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.3,
      "position": [
        12224,
        4624
      ],
      "id": "bfbf4b8d-0784-4389-821a-c9c084f79414",
      "name": "HTTP Request2"
    },
    {
      "parameters": {
        "jsCode": "// –û–±–Ω–æ–≤–ª—ë–Ω–Ω—ã–π –∫–æ–¥ –¥–ª—è Code Node (–ø–æ—Å–ª–µ Switch 'url')\ntry {\n  const item = $input.first().json;\n  const videoUrl = item.contentData; // –¢–µ–ø–µ—Ä—å —ç—Ç–æ –ø—Ä—è–º–∞—è —Å—Å—ã–ª–∫–∞ –Ω–∞ –≤–∏–¥–µ–æ—Ñ–∞–π–ª\n  \n  console.log('üé¨ –ü–æ–ª—É—á–µ–Ω–∞ —Å—Å—ã–ª–∫–∞ –Ω–∞ –≤–∏–¥–µ–æ—Ñ–∞–π–ª:', videoUrl);\n  \n  // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ —ç—Ç–æ –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ —Å—Å—ã–ª–∫–∞ –Ω–∞ —Ñ–∞–π–ª\n  const videoExtensions = ['.mp4', '.avi', '.mov', '.mkv', '.webm', '.flv'];\n  const isVideoFile = videoExtensions.some(ext => \n    videoUrl.toLowerCase().includes(ext)\n  );\n  \n  if (!isVideoFile && !videoUrl.includes('dl=1') && !videoUrl.includes('download')) {\n    console.warn('‚ö†Ô∏è –°—Å—ã–ª–∫–∞ –º–æ–∂–µ—Ç –±—ã—Ç—å –Ω–µ –Ω–∞ –ø—Ä—è–º–æ–π —Ñ–∞–π–ª. –í–æ–∑–º–æ–∂–Ω—ã –ø—Ä–æ–±–ª–µ–º—ã —Å –∑–∞–≥—Ä—É–∑–∫–æ–π.');\n  }\n  \n  return [{\n    json: {\n      ...item,\n      videoUrl: videoUrl,\n      isDirectVideoLink: true,\n      readyForDownload: true,\n      // –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –±—É–¥—É—Ç –ø–æ–ª—É—á–µ–Ω—ã –ø–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–∞–π–ª–∞\n    }\n  }];\n  \n} catch (error) {\n  console.error('‚ùå –û—à–∏–±–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Å—Å—ã–ª–∫–∏:', error);\n  return [{\n    json: {\n      ...$input.first().json,\n      error: error.message,\n      readyForDownload: false\n    }\n  }];\n}"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        12080,
        4624
      ],
      "id": "37378b51-c192-4c02-b5b7-1dde05cf514e",
      "name": "Code in JavaScript1"
    },
    {
      "parameters": {
        "jsCode": "try {\n  const item = $input.first().json;\n  const binaryData = $input.first().binary;\n  \n  if (!binaryData || !binaryData.data) {\n    throw new Error('–§–∞–π–ª –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω –∏–ª–∏ –±–∏–Ω–∞—Ä–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç');\n  }\n  \n  console.log('‚úÖ –í–∏–¥–µ–æ—Ñ–∞–π–ª –∑–∞–≥—Ä—É–∂–µ–Ω —É—Å–ø–µ—à–Ω–æ');\n  console.log('üìè –†–∞–∑–º–µ—Ä:', Math.round(binaryData.data.length / 1024 / 1024), 'MB');\n  console.log('üìÑ –ò–º—è —Ñ–∞–π–ª–∞:', binaryData.fileName || 'video.mp4');\n  console.log('üéûÔ∏è MIME —Ç–∏–ø:', binaryData.mimeType || 'video/mp4');\n  \n  return [{\n    json: {\n      ...item,\n      videoFileSize: Math.round(binaryData.data.length / 1024 / 1024) + ' MB',\n      videoFileName: binaryData.fileName || 'downloaded_video.mp4',\n      videoMimeType: binaryData.mimeType || 'video/mp4',\n      downloadSuccess: true,\n      downloadTimestamp: new Date().toISOString()\n    },\n    binary: binaryData\n  }];\n  \n} catch (error) {\n  console.error('‚ùå –û—à–∏–±–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω–æ–≥–æ —Ñ–∞–π–ª–∞:', error);\n  return [{\n    json: {\n      ...$input.first().json,\n      downloadSuccess: false,\n      error: error.message\n    }\n  }];\n}"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        12384,
        4624
      ],
      "id": "ba2f5f97-aa93-4982-b2f0-2e5503f6755b",
      "name": "Code in JavaScript2"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "http://video_processing:8080/extract_audio",
        "sendBody": true,
        "contentType": "multipart-form-data",
        "bodyParameters": {
          "parameters": [
            {
              "parameterType": "formBinaryData",
              "name": "video",
              "inputDataFieldName": "data"
            }
          ]
        },
        "options": {
          "response": {
            "response": {
              "responseFormat": "file",
              "outputPropertyName": "dataAudio"
            }
          },
          "timeout": 60000
        }
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.3,
      "position": [
        12544,
        4400
      ],
      "id": "7d36146e-0101-4254-8753-0c8b8666acd5",
      "name": "HTTP Request3"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "http://video_processing:8000/transcribe_to_srt",
        "sendBody": true,
        "contentType": "multipart-form-data",
        "bodyParameters": {
          "parameters": [
            {
              "parameterType": "formBinaryData",
              "name": "audio_file",
              "inputDataFieldName": "dataAudio"
            }
          ]
        },
        "options": {
          "response": {
            "response": {
              "responseFormat": "file",
              "outputPropertyName": "dataSub"
            }
          },
          "timeout": 60000
        }
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.3,
      "position": [
        12736,
        4400
      ],
      "id": "1f8e3400-3169-4bf7-ab1c-ee0fb15f5311",
      "name": "HTTP Request4"
    },
    {
      "parameters": {
        "jsCode": "// –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ SRT —Ñ–∞–π–ª–∞ –≤ —Ç–µ–∫—Å—Ç –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –≤ LLM\ntry {\n  const item = $input.first();\n  const binaryData = item.binary?.dataSub;\n  \n  if (!binaryData || !binaryData.data) {\n    throw new Error('SRT —Ñ–∞–π–ª –Ω–µ –Ω–∞–π–¥–µ–Ω –≤ –±–∏–Ω–∞—Ä–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö');\n  }\n  \n  // –ß–∏—Ç–∞–µ–º SRT —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –∫–∞–∫ —Å—Ç—Ä–æ–∫—É UTF-8\n  let srtContent;\n  if (Buffer.isBuffer(binaryData.data)) {\n    srtContent = binaryData.data.toString('utf-8');\n  } else if (typeof binaryData.data === 'string') {\n    srtContent = binaryData.data;\n  } else {\n    // –ü—Ä–æ–±—É–µ–º –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞—Ç—å –≤ Buffer, –µ—Å–ª–∏ —ç—Ç–æ –¥—Ä—É–≥–æ–π —Ñ–æ—Ä–º–∞—Ç\n    srtContent = Buffer.from(binaryData.data).toString('utf-8');\n  }\n  \n  console.log('üìÑ SRT —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ (–ø–µ—Ä–≤—ã–µ 500 —Å–∏–º–≤–æ–ª–æ–≤):', srtContent.substring(0, 500));\n  console.log('üìè –î–ª–∏–Ω–∞ SRT:', srtContent.length);\n  \n  // –£–±–µ–∂–¥–∞–µ–º—Å—è, —á—Ç–æ —ç—Ç–æ –Ω–µ base64\n  if (srtContent.match(/^[A-Za-z0-9+/=]+$/) && srtContent.length > 100) {\n    console.log('‚ö†Ô∏è –ü–æ—Ö–æ–∂–µ –Ω–∞ base64, –ø—Ä–æ–±—É–µ–º –¥–µ–∫–æ–¥–∏—Ä–æ–≤–∞—Ç—å...');\n    try {\n      srtContent = Buffer.from(srtContent, 'base64').toString('utf-8');\n      console.log('‚úÖ Base64 –¥–µ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω');\n    } catch (e) {\n      console.log('‚ö†Ô∏è –ù–µ —É–¥–∞–ª–æ—Å—å –¥–µ–∫–æ–¥–∏—Ä–æ–≤–∞—Ç—å –∫–∞–∫ base64, –∏—Å–ø–æ–ª—å–∑—É–µ–º –∫–∞–∫ –µ—Å—Ç—å');\n    }\n  }\n  \n  return [{\n    json: {\n      ...item.json,\n      srtContent: srtContent,\n      srtLength: srtContent.length\n    },\n    binary: item.binary\n  }];\n  \n} catch (error) {\n  console.error('‚ùå –û—à–∏–±–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ SRT:', error);\n  return [{\n    json: {\n      ...$input.first().json,\n      error: error.message\n    }\n  }];\n}"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        12896,
        4400
      ],
      "id": "96789880-75a1-47ed-9e46-949d98924357",
      "name": "Code: Prepare SRT for Translation"
    },
    {
      "parameters": {
        "jsCode": "// –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–Ω–æ–π –º–æ–¥–µ–ª–∏ –∏ –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∑–∞–ø—Ä–æ—Å–∞ –∫ LLM\ntry {\n  const item = $input.first();\n  let srtContent = item.json.srtContent;\n  \n  if (!srtContent) {\n    throw new Error('SRT –∫–æ–Ω—Ç–µ–Ω—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω');\n  }\n  \n  // –£–±–µ–∂–¥–∞–µ–º—Å—è, —á—Ç–æ SRT –∫–æ–Ω—Ç–µ–Ω—Ç - —ç—Ç–æ —Ç–µ–∫—Å—Ç, –∞ –Ω–µ base64\n  if (srtContent.match(/^[A-Za-z0-9+/=]+$/) && srtContent.length > 100 && !srtContent.includes('-->')) {\n    console.log('‚ö†Ô∏è –ü–æ—Ö–æ–∂–µ –Ω–∞ base64, –¥–µ–∫–æ–¥–∏—Ä—É–µ–º...');\n    try {\n      const decoded = Buffer.from(srtContent, 'base64').toString('utf-8');\n      if (decoded.includes('-->')) {\n        srtContent = decoded;\n        console.log('‚úÖ Base64 –¥–µ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω —É—Å–ø–µ—à–Ω–æ');\n      }\n    } catch (e) {\n      console.log('‚ö†Ô∏è –ù–µ —É–¥–∞–ª–æ—Å—å –¥–µ–∫–æ–¥–∏—Ä–æ–≤–∞—Ç—å –∫–∞–∫ base64');\n    }\n  }\n  \n  console.log('üìÑ –î–ª–∏–Ω–∞ SRT –¥–ª—è –ø–µ—Ä–µ–≤–æ–¥–∞:', srtContent.length);\n  console.log('üìù –ü–µ—Ä–≤—ã–µ 200 —Å–∏–º–≤–æ–ª–æ–≤ SRT:', srtContent.substring(0, 200));\n  \n  // –ú–æ–¥–µ–ª—å –∏–∑ docker-compose.yml (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é Qwen/Qwen2.5-7B-Instruct)\n  // vLLM –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –º–æ–¥–µ–ª—å –∏–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π –æ–∫—Ä—É–∂–µ–Ω–∏—è MODEL\n  // –ï—Å–ª–∏ –º–æ–¥–µ–ª—å –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω–∞, –ø–æ–ø—Ä–æ–±—É–µ–º –ø–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ –º–æ–¥–µ–ª–µ–π —Å —Å–µ—Ä–≤–µ—Ä–∞\n  let modelName = 'Qwen/Qwen2.5-7B-Instruct'; // –ú–æ–¥–µ–ª—å –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –∏–∑ docker-compose.yml\n  \n  // –ü–æ–ø—Ä–æ–±—É–µ–º –ø–æ–ª—É—á–∏—Ç—å –º–æ–¥–µ–ª—å —Å —Å–µ—Ä–≤–µ—Ä–∞ —á–µ—Ä–µ–∑ /models endpoint\n  try {\n    const https = require('https');\n    const http = require('http');\n    \n    // –°–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π –∑–∞–ø—Ä–æ—Å –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è –≤ n8n Code node\n    // –ü–æ—ç—Ç–æ–º—É –∏—Å–ø–æ–ª—å–∑—É–µ–º –º–æ–¥–µ–ª—å –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é\n    // –í docker-compose.yml —É–∫–∞–∑–∞–Ω–æ: MODEL=${LLM_MODEL:-Qwen/Qwen2.5-7B-Instruct}\n    console.log('ü§ñ –ò—Å–ø–æ–ª—å–∑—É–µ–º –º–æ–¥–µ–ª—å –∏–∑ docker-compose.yml:', modelName);\n  } catch (e) {\n    console.log('‚ö†Ô∏è –ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–ª—É—á–∏—Ç—å –º–æ–¥–µ–ª—å —Å —Å–µ—Ä–≤–µ—Ä–∞, –∏—Å–ø–æ–ª—å–∑—É–µ–º –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é');\n  }\n  \n  // –§–æ—Ä–º–∏—Ä—É–µ–º –∑–∞–ø—Ä–æ—Å –∫ LLM\n  const llmRequest = {\n    model: modelName,\n    messages: [\n      {\n        role: 'system',\n        content: '–¢—ã –ø–µ—Ä–µ–≤–æ–¥—á–∏–∫ —Å—É–±—Ç–∏—Ç—Ä–æ–≤. –ü–µ—Ä–µ–≤–µ–¥–∏ –∞–Ω–≥–ª–∏–π—Å–∫–∏–µ —Å—É–±—Ç–∏—Ç—Ä—ã –∏–∑ SRT —Ñ–∞–π–ª–∞ –Ω–∞ —Ä—É—Å—Å–∫–∏–π —è–∑—ã–∫, —Å–æ—Ö—Ä–∞–Ω–∏–≤ —Ñ–æ—Ä–º–∞—Ç SRT –∏ –≤—Ä–µ–º–µ–Ω–Ω—ã–µ –º–µ—Ç–∫–∏. –í–µ—Ä–Ω–∏ —Ç–æ–ª—å–∫–æ –ø–µ—Ä–µ–≤–µ–¥–µ–Ω–Ω—ã–π SRT –∫–æ–Ω—Ç–µ–Ω—Ç –±–µ–∑ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –æ–±—ä—è—Å–Ω–µ–Ω–∏–π.'\n      },\n      {\n        role: 'user',\n        content: srtContent\n      }\n    ],\n    temperature: 0.3,\n    max_tokens: 4000\n  };\n  \n  return [{\n    json: {\n      ...item.json,\n      srtContent: srtContent, // –û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–π SRT –∫–æ–Ω—Ç–µ–Ω—Ç\n      llmRequest: llmRequest,\n      modelName: modelName\n    },\n    binary: item.binary\n  }];\n  \n} catch (error) {\n  console.error('‚ùå –û—à–∏–±–∫–∞ –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∏ –∑–∞–ø—Ä–æ—Å–∞ –∫ LLM:', error);\n  return [{\n    json: {\n      ...$input.first().json,\n      error: error.message\n    }\n  }];\n}"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        13072,
        4400
      ],
      "id": "163aa9a1-e432-4c23-9fa8-558d1fedc427",
      "name": "Code: Prepare LLM Request"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "http://vllm_server:8000/v1/chat/completions",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={{ $json.llmRequest }}",
        "options": {
          "response": {
            "response": {
              "responseFormat": "json"
            }
          },
          "timeout": 300000
        }
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.3,
      "position": [
        13520,
        4400
      ],
      "id": "4b6553fd-7677-4813-8ea7-0ad0386d7b9e",
      "name": "HTTP Request5: Translate SRT"
    },
    {
      "parameters": {
        "jsCode": "// –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –æ—Ç–≤–µ—Ç–∞ LLM –≤ –±–∏–Ω–∞—Ä–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ SRT\ntry {\n  const item = $input.first();\n  const llmResponse = item.json;\n  \n  // –ò–∑–≤–ª–µ–∫–∞–µ–º –ø–µ—Ä–µ–≤–µ–¥–µ–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç –∏–∑ –æ—Ç–≤–µ—Ç–∞ LLM\n  let translatedSrt = '';\n  \n  if (llmResponse.choices && llmResponse.choices.length > 0) {\n    translatedSrt = llmResponse.choices[0].message.content.trim();\n  } else if (llmResponse.content) {\n    translatedSrt = llmResponse.content.trim();\n  } else {\n    throw new Error('–ù–µ –Ω–∞–π–¥–µ–Ω –ø–µ—Ä–µ–≤–µ–¥–µ–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç –≤ –æ—Ç–≤–µ—Ç–µ LLM');\n  }\n  \n  console.log('üìÑ –°—ã—Ä–æ–π –æ—Ç–≤–µ—Ç LLM (–ø–µ—Ä–≤—ã–µ 500 —Å–∏–º–≤–æ–ª–æ–≤):', translatedSrt.substring(0, 500));\n  \n  // –û—á–∏—â–∞–µ–º –æ—Ç–≤–µ—Ç –æ—Ç —Ç–µ–≥–æ–≤ thinking –∏ –¥—Ä—É–≥–∏—Ö –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–æ–≤ LLM\n  // –£–¥–∞–ª—è–µ–º —Ç–µ–≥–∏ <think>...</think>\n  translatedSrt = translatedSrt.replace(/<think>[\\s\\S]*?<\\/think>/gi, '');\n  \n  // –£–¥–∞–ª—è–µ–º –¥—Ä—É–≥–∏–µ –≤–æ–∑–º–æ–∂–Ω—ã–µ —Ç–µ–≥–∏ XML/HTML\n  translatedSrt = translatedSrt.replace(/<[^>]+>/g, '');\n  \n  // –£–¥–∞–ª—è–µ–º markdown code blocks –µ—Å–ª–∏ –µ—Å—Ç—å\n  translatedSrt = translatedSrt.replace(/```[\\s\\S]*?```/g, '');\n  \n  // –ò—â–µ–º –Ω–∞—á–∞–ª–æ SRT –∫–æ–Ω—Ç–µ–Ω—Ç–∞ (–æ–±—ã—á–Ω–æ –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å —á–∏—Å–ª–∞ –∏–ª–∏ –≤—Ä–µ–º–µ–Ω–∏)\n  // SRT —Ñ–æ—Ä–º–∞—Ç: —á–∏—Å–ª–æ, –∑–∞—Ç–µ–º –≤—Ä–µ–º—è –≤ —Ñ–æ—Ä–º–∞—Ç–µ HH:MM:SS,mmm --> HH:MM:SS,mmm\n  const srtPattern = /(\\d+\\s*\\n\\d{2}:\\d{2}:\\d{2}[,\\.]\\d{3}\\s*-->\\s*\\d{2}:\\d{2}:\\d{2}[,\\.]\\d{3})/;\n  const match = translatedSrt.match(srtPattern);\n  \n  if (match && match.index !== undefined) {\n    // –ù–∞—Ö–æ–¥–∏–º –Ω–∞—á–∞–ª–æ SRT –∫–æ–Ω—Ç–µ–Ω—Ç–∞\n    translatedSrt = translatedSrt.substring(match.index).trim();\n    console.log('‚úÖ –ù–∞–π–¥–µ–Ω SRT –∫–æ–Ω—Ç–µ–Ω—Ç, –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å:', translatedSrt.substring(0, 100));\n  } else {\n    // –ï—Å–ª–∏ –ø–∞—Ç—Ç–µ—Ä–Ω –Ω–µ –Ω–∞–π–¥–µ–Ω, –ø—Ä–æ–±—É–µ–º –Ω–∞–π—Ç–∏ –ø–æ –¥—Ä—É–≥–∏–º –ø—Ä–∏–∑–Ω–∞–∫–∞–º\n    // –ò—â–µ–º —Å—Ç—Ä–æ–∫–∏ —Å –≤—Ä–µ–º–µ–Ω–Ω—ã–º–∏ –º–µ—Ç–∫–∞–º–∏\n    const timePattern = /\\d{2}:\\d{2}:\\d{2}[,\\.]\\d{3}\\s*-->\\s*\\d{2}:\\d{2}:\\d{2}[,\\.]\\d{3}/;\n    const timeMatch = translatedSrt.match(timePattern);\n    if (timeMatch && timeMatch.index !== undefined) {\n      // –ù–∞—Ö–æ–¥–∏–º –Ω–∞—á–∞–ª–æ —Å –≤—Ä–µ–º–µ–Ω–Ω–æ–π –º–µ—Ç–∫–∏\n      translatedSrt = translatedSrt.substring(timeMatch.index).trim();\n      // –î–æ–±–∞–≤–ª—è–µ–º –Ω–æ–º–µ—Ä —Å—É–±—Ç–∏—Ç—Ä–∞ –≤ –Ω–∞—á–∞–ª–æ, –µ—Å–ª–∏ –µ–≥–æ –Ω–µ—Ç\n      if (!/^\\d+\\s*$/.test(translatedSrt.split('\\n')[0])) {\n        translatedSrt = '1\\n' + translatedSrt;\n      }\n      console.log('‚úÖ –ù–∞–π–¥–µ–Ω SRT –∫–æ–Ω—Ç–µ–Ω—Ç –ø–æ –≤—Ä–µ–º–µ–Ω–Ω—ã–º –º–µ—Ç–∫–∞–º');\n    } else {\n      console.warn('‚ö†Ô∏è –ù–µ –Ω–∞–π–¥–µ–Ω –ø–∞—Ç—Ç–µ—Ä–Ω SRT, –∏—Å–ø–æ–ª—å–∑—É–µ–º –≤–µ—Å—å —Ç–µ–∫—Å—Ç');\n    }\n  }\n  \n  // –û—á–∏—â–∞–µ–º –æ—Ç –ª–∏—à–Ω–∏—Ö –ø—Ä–æ–±–µ–ª–æ–≤ –≤ –Ω–∞—á–∞–ª–µ –∏ –∫–æ–Ω—Ü–µ\n  translatedSrt = translatedSrt.trim();\n  \n  // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ —ç—Ç–æ –ø–æ—Ö–æ–∂–µ –Ω–∞ SRT (—Å–æ–¥–µ—Ä–∂–∏—Ç –≤—Ä–µ–º–µ–Ω–Ω—ã–µ –º–µ—Ç–∫–∏)\n  if (!translatedSrt.includes('-->')) {\n    throw new Error('–ü–µ—Ä–µ–≤–µ–¥–µ–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç –Ω–µ —Å–æ–¥–µ—Ä–∂–∏—Ç –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –º–µ—Ç–æ–∫ SRT (-->)');\n  }\n  \n  console.log('‚úÖ –û—á–∏—â–µ–Ω–Ω—ã–π SRT –ø–æ–ª—É—á–µ–Ω, –¥–ª–∏–Ω–∞:', translatedSrt.length);\n  console.log('üìÑ –ü–µ—Ä–≤—ã–µ 500 —Å–∏–º–≤–æ–ª–æ–≤ –æ—á–∏—â–µ–Ω–Ω–æ–≥–æ SRT:', translatedSrt.substring(0, 500));\n  \n  // –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º –≤ Buffer –¥–ª—è –±–∏–Ω–∞—Ä–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö\n  const srtBuffer = Buffer.from(translatedSrt, 'utf-8');\n  \n  return [{\n    json: {\n      ...item.json,\n      translatedSrtLength: translatedSrt.length\n    },\n    binary: {\n      dataTranslatedPubs: {\n        data: srtBuffer,\n        mimeType: 'text/plain',\n        fileName: 'subtitles_ru.srt'\n      }\n    }\n  }];\n  \n} catch (error) {\n  console.error('‚ùå –û—à–∏–±–∫–∞ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è –æ—Ç–≤–µ—Ç–∞ LLM:', error);\n  return [{\n    json: {\n      ...$input.first().json,\n      error: error.message\n    }\n  }];\n}"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        13664,
        4400
      ],
      "id": "a59c5247-bd58-4365-8f33-e88f87115cbf",
      "name": "Code: Convert LLM Response to SRT"
    },
    {
      "parameters": {
        "jsCode": "// –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏—Å—Ö–æ–¥–Ω–æ–≥–æ –≤–∏–¥–µ–æ –∏ —Å—É–±—Ç–∏—Ç—Ä–æ–≤ –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Å—É–±—Ç–∏—Ç—Ä–æ–≤\ntry {\n  const item = $input.first();\n  \n  console.log('üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤—Ö–æ–¥—è—â–∏—Ö –¥–∞–Ω–Ω—ã—Ö:');\n  console.log('  - item.binary keys:', item.binary ? Object.keys(item.binary) : '–Ω–µ—Ç binary');\n  \n  // –ü–æ–ª—É—á–∞–µ–º –ø–µ—Ä–µ–≤–µ–¥–µ–Ω–Ω—ã–µ —Å—É–±—Ç–∏—Ç—Ä—ã –∏–∑ —Ç–µ–∫—É—â–µ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞ (–æ—Ç Code: Convert LLM Response to SRT)\n  let translatedSubtitles = null;\n  if (item.binary && item.binary.dataTranslatedPubs) {\n    translatedSubtitles = item.binary.dataTranslatedPubs;\n    console.log('‚úÖ –°—É–±—Ç–∏—Ç—Ä—ã –Ω–∞–π–¥–µ–Ω—ã –≤ —Ç–µ–∫—É—â–µ–º —ç–ª–µ–º–µ–Ω—Ç–µ');\n  } else {\n    // –ü—Ä–æ–±—É–µ–º –ø–æ–ª—É—á–∏—Ç—å –∏–∑ –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ —É–∑–ª–∞\n    try {\n      const prevItem = $('Code: Convert LLM Response to SRT').first();\n      if (prevItem && prevItem.binary && prevItem.binary.dataTranslatedPubs) {\n        translatedSubtitles = prevItem.binary.dataTranslatedPubs;\n        console.log('‚úÖ –°—É–±—Ç–∏—Ç—Ä—ã –Ω–∞–π–¥–µ–Ω—ã –≤ –ø—Ä–µ–¥—ã–¥—É—â–µ–º —É–∑–ª–µ');\n      }\n    } catch (e) {\n      console.log('‚ö†Ô∏è –ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–ª—É—á–∏—Ç—å —Å—É–±—Ç–∏—Ç—Ä—ã –∏–∑ –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ —É–∑–ª–∞:', e.message);\n    }\n  }\n  \n  if (!translatedSubtitles) {\n    throw new Error('–ü–µ—Ä–µ–≤–µ–¥–µ–Ω–Ω—ã–µ —Å—É–±—Ç–∏—Ç—Ä—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ —É–∑–µ–ª Code: Convert LLM Response to SRT —Å–æ–∑–¥–∞–ª dataTranslatedPubs.');\n  }\n  \n  // –ò—â–µ–º –∏—Å—Ö–æ–¥–Ω–æ–µ –≤–∏–¥–µ–æ –≤ –±–∏–Ω–∞—Ä–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –∏–∑ –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö —É–∑–ª–æ–≤\n  let originalVideo = null;\n  let originalVideoMeta = null;\n  \n  // –ü—Ä–æ–±—É–µ–º –ø–æ–ª—É—á–∏—Ç—å –∏–∑ —É–∑–ª–∞ Code in JavaScript2 (–¥–ª—è URL)\n  try {\n    const js2Item = $('Code in JavaScript2').first();\n    if (js2Item && js2Item.binary && js2Item.binary.data) {\n      // –í n8n –±–∏–Ω–∞—Ä–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ: { data: Buffer, fileName: string, mimeType: string }\n      originalVideo = js2Item.binary.data.data || js2Item.binary.data; // Buffer –¥–∞–Ω–Ω—ã—Ö\n      originalVideoMeta = {\n        fileName: js2Item.binary.data.fileName || js2Item.json.videoFileName || 'video.mp4',\n        mimeType: js2Item.binary.data.mimeType || js2Item.json.videoMimeType || 'video/mp4'\n      };\n      console.log('‚úÖ –ò—Å—Ö–æ–¥–Ω–æ–µ –≤–∏–¥–µ–æ –Ω–∞–π–¥–µ–Ω–æ –≤ Code in JavaScript2');\n    }\n  } catch (e) {\n    console.log('‚ö†Ô∏è –ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–ª—É—á–∏—Ç—å –∏–∑ Code in JavaScript2:', e.message);\n  }\n  \n  // –ï—Å–ª–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ, –ø—Ä–æ–±—É–µ–º –ø–æ–ª—É—á–∏—Ç—å –∏–∑ —É–∑–ª–∞ Get a file (–¥–ª—è —Ñ–∞–π–ª–∞ –∏–∑ Telegram)\n  if (!originalVideo) {\n    try {\n      const getFileItem = $('Get a file').first();\n      if (getFileItem && getFileItem.binary && getFileItem.binary.data) {\n        originalVideo = getFileItem.binary.data.data || getFileItem.binary.data;\n        originalVideoMeta = {\n          fileName: getFileItem.binary.data.fileName || 'video.mp4',\n          mimeType: getFileItem.binary.data.mimeType || 'video/mp4'\n        };\n        console.log('‚úÖ –ò—Å—Ö–æ–¥–Ω–æ–µ –≤–∏–¥–µ–æ –Ω–∞–π–¥–µ–Ω–æ –≤ Get a file');\n      }\n    } catch (e) {\n      console.log('‚ö†Ô∏è –ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–ª—É—á–∏—Ç—å –∏–∑ Get a file:', e.message);\n    }\n  }\n  \n  if (!originalVideo) {\n    throw new Error('–ò—Å—Ö–æ–¥–Ω–æ–µ –≤–∏–¥–µ–æ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –≤–∏–¥–µ–æ –±—ã–ª–æ –∑–∞–≥—Ä—É–∂–µ–Ω–æ –≤ —É–∑–ª–µ Code in JavaScript2 –∏–ª–∏ Get a file.');\n  }\n  \n  console.log('üìπ –ò—Å—Ö–æ–¥–Ω–æ–µ –≤–∏–¥–µ–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–æ, —Ä–∞–∑–º–µ—Ä:', Math.round(originalVideo.length / 1024 / 1024), 'MB');\n  console.log('üìÑ –°—É–±—Ç–∏—Ç—Ä—ã —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã, —Ä–∞–∑–º–µ—Ä:', translatedSubtitles.data ? Math.round(translatedSubtitles.data.length / 1024) : '–Ω–µ–∏–∑–≤–µ—Å—Ç–Ω–æ', 'KB');\n  \n  // –§–æ—Ä–º–∏—Ä—É–µ–º –ø—Ä–∞–≤–∏–ª—å–Ω—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É –±–∏–Ω–∞—Ä–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –¥–ª—è n8n\n  // –í n8n –±–∏–Ω–∞—Ä–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∏–º–µ—é—Ç —Ñ–æ—Ä–º–∞—Ç: { data: { data: Buffer, fileName: string, mimeType: string } }\n  const binaryData = {\n    data: {\n      data: originalVideo,\n      fileName: originalVideoMeta.fileName || 'video.mp4',\n      mimeType: originalVideoMeta.mimeType || 'video/mp4'\n    },\n    dataTranslatedPubs: translatedSubtitles  // –°–æ—Ö—Ä–∞–Ω—è–µ–º –ø–µ—Ä–µ–≤–µ–¥–µ–Ω–Ω—ã–µ —Å—É–±—Ç–∏—Ç—Ä—ã\n  };\n  \n  console.log('‚úÖ –ë–∏–Ω–∞—Ä–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ —Å—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω—ã:');\n  console.log('  - data:', binaryData.data ? '–µ—Å—Ç—å' : '–Ω–µ—Ç');\n  console.log('  - dataTranslatedPubs:', binaryData.dataTranslatedPubs ? '–µ—Å—Ç—å' : '–Ω–µ—Ç');\n  \n  // –°–æ—Ö—Ä–∞–Ω—è–µ–º –∏—Å—Ö–æ–¥–Ω–æ–µ –≤–∏–¥–µ–æ –∏ –ø–µ—Ä–µ–≤–µ–¥–µ–Ω–Ω—ã–µ —Å—É–±—Ç–∏—Ç—Ä—ã\n  return [{\n    json: {\n      ...item.json,\n      originalVideoSize: Math.round(originalVideo.length / 1024 / 1024) + ' MB'\n    },\n    binary: binaryData\n  }];\n  \n} catch (error) {\n  console.error('‚ùå –û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –∏—Å—Ö–æ–¥–Ω–æ–≥–æ –≤–∏–¥–µ–æ:', error);\n  console.error('Stack:', error.stack);\n  return [{\n    json: {\n      ...$input.first().json,\n      error: error.message\n    }\n  }];\n}"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        13808,
        4400
      ],
      "id": "6a8ea273-84af-40bd-a896-d8e269abf53e",
      "name": "Code: Preserve Original Video"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "http://video_processing:8080/burn_subtitles",
        "sendBody": true,
        "contentType": "multipart-form-data",
        "bodyParameters": {
          "parameters": [
            {
              "parameterType": "formBinaryData",
              "name": "video",
              "inputDataFieldName": "data"
            },
            {
              "parameterType": "formBinaryData",
              "name": "subtitles",
              "inputDataFieldName": "dataTranslatedPubs"
            }
          ]
        },
        "options": {
          "response": {},
          "timeout": 60000
        }
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.3,
      "position": [
        13952,
        4400
      ],
      "id": "a676d122-b184-4fcc-89ed-1724926edfae",
      "name": "HTTP Request6"
    },
    {
      "parameters": {
        "operation": "sendVideo",
        "chatId": "={{ $('Code in JavaScript').item.json.chatId }}",
        "binaryData": true,
        "binaryPropertyName": "Final",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        14240,
        4400
      ],
      "id": "1268b48b-efd1-43cf-9d75-8bd261dd2c8d",
      "name": "Send a video",
      "webhookId": "2e4226eb-68f0-45d7-a478-ea1fe06ee5fe",
      "credentials": {
        "telegramApi": {
          "id": "2QLDYIGGwgd7xA0m",
          "name": "Telegram account"
        }
      }
    },
    {
      "parameters": {
        "resource": "file",
        "fileId": "={{ $('Code in JavaScript').item.json.videoInfo.fileId }}",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        12096,
        4400
      ],
      "id": "4a867bda-806a-40a1-b701-dc7232d11a5b",
      "name": "Get a file",
      "webhookId": "a7917f45-0d1e-43e3-a2a3-3bfbca3e91bb",
      "credentials": {
        "telegramApi": {
          "id": "2QLDYIGGwgd7xA0m",
          "name": "Telegram account"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "try {\n  const updates = $input.first().json?.result || [];\n  let lastId = 0;\n  \n  // –ù–∞—Ö–æ–¥–∏–º –ø–æ—Å–ª–µ–¥–Ω–∏–π update_id\n  for (const update of updates) {\n    if (update.update_id > lastId) {\n      lastId = update.update_id;\n    }\n  }\n  \n  // –°–æ—Ö—Ä–∞–Ω—è–µ–º –¥–ª—è —Å–ª–µ–¥—É—é—â–µ–≥–æ –∑–∞–ø—É—Å–∫–∞\n  if (lastId > 0) {\n    $vars.set(\"telegramOffset\", lastId + 1);\n    console.log(`‚úÖ Offset —Å–æ—Ö—Ä–∞–Ω–µ–Ω –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ: ${lastId + 1}`);\n  }\n  \n  return $input.all();\n} catch(e) {\n  console.error('Error:', e);\n  return [];\n}"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        11360,
        4480
      ],
      "id": "57b11cc2-822b-4aee-873d-ae09a0133390",
      "name": "Code in JavaScript3"
    },
    {
      "parameters": {
        "jsCode": "// –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –≤–∏–¥–µ–æ –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –≤ Telegram\ntry {\n  const item = $input.first();\n  \n  console.log('üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –≤ Telegram:');\n  console.log('  - binary keys:', item.binary ? Object.keys(item.binary) : '–Ω–µ—Ç binary');\n  \n  // –ü–æ–ª—É—á–∞–µ–º –≤–∏–¥–µ–æ –∏–∑ –ø–æ–ª—è Final (—Ä–µ–∑—É–ª—å—Ç–∞—Ç HTTP Request6)\n  let videoData = null;\n  \n  if (item.binary && item.binary.Final) {\n    videoData = item.binary.Final;\n    console.log('‚úÖ –í–∏–¥–µ–æ –Ω–∞–π–¥–µ–Ω–æ –≤ binary.Final');\n  } else if (item.binary && item.binary.data) {\n    videoData = item.binary.data;\n    console.log('‚úÖ –í–∏–¥–µ–æ –Ω–∞–π–¥–µ–Ω–æ –≤ binary.data');\n  } else {\n    // –ü—Ä–æ–±—É–µ–º –Ω–∞–π—Ç–∏ –≤ –ª—é–±–æ–º –±–∏–Ω–∞—Ä–Ω–æ–º –ø–æ–ª–µ\n    const binaryKeys = Object.keys(item.binary || {});\n    if (binaryKeys.length > 0) {\n      videoData = item.binary[binaryKeys[0]];\n      console.log(`‚úÖ –í–∏–¥–µ–æ –Ω–∞–π–¥–µ–Ω–æ –≤ binary.${binaryKeys[0]}`);\n    }\n  }\n  \n  if (!videoData) {\n    throw new Error('–í–∏–¥–µ–æ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ –≤ –±–∏–Ω–∞—Ä–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ HTTP Request6 –≤–µ—Ä–Ω—É–ª –≤–∏–¥–µ–æ –≤ –ø–æ–ª–µ Final.');\n  }\n  \n  // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—Ç—Ä—É–∫—Ç—É—Ä—É –¥–∞–Ω–Ω—ã—Ö\n  if (!videoData.data) {\n    // –ï—Å–ª–∏ data –Ω–µ—Ç, –≤–æ–∑–º–æ–∂–Ω–æ —ç—Ç–æ —É–∂–µ Buffer\n    if (Buffer.isBuffer(videoData)) {\n      videoData = {\n        data: videoData,\n        fileName: 'video_with_subtitles.mp4',\n        mimeType: 'video/mp4'\n      };\n      console.log('‚úÖ –í–∏–¥–µ–æ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–æ –∏–∑ Buffer');\n    } else {\n      throw new Error('–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –±–∏–Ω–∞—Ä–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è. –û–∂–∏–¥–∞–µ—Ç—Å—è { data: Buffer, fileName: string, mimeType: string }');\n    }\n  }\n  \n  // –£–±–µ–∂–¥–∞–µ–º—Å—è, —á—Ç–æ –µ—Å—Ç—å fileName –∏ mimeType\n  if (!videoData.fileName) {\n    videoData.fileName = 'video_with_subtitles.mp4';\n  }\n  if (!videoData.mimeType) {\n    videoData.mimeType = 'video/mp4';\n  }\n  \n  console.log('üìπ –í–∏–¥–µ–æ –ø–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω–æ:');\n  console.log('  - fileName:', videoData.fileName);\n  console.log('  - mimeType:', videoData.mimeType);\n  console.log('  - —Ä–∞–∑–º–µ—Ä:', videoData.data ? Math.round(videoData.data.length / 1024 / 1024) : '–Ω–µ–∏–∑–≤–µ—Å—Ç–Ω–æ', 'MB');\n  \n  // –§–æ—Ä–º–∏—Ä—É–µ–º –ø—Ä–∞–≤–∏–ª—å–Ω—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É –¥–ª—è Telegram\n  return [{\n    json: {\n      ...item.json,\n      chatId: $('Code in JavaScript').first().json.chatId\n    },\n    binary: {\n      Final: videoData  // –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–ª—è Telegram node\n    }\n  }];\n  \n} catch (error) {\n  console.error('‚ùå –û—à–∏–±–∫–∞ –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∏ –≤–∏–¥–µ–æ:', error);\n  console.error('Stack:', error.stack);\n  return [{\n    json: {\n      ...$input.first().json,\n      error: error.message\n    }\n  }];\n}"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        14096,
        4400
      ],
      "id": "b3d5a5a6-761e-47ea-b534-09d9349ac174",
      "name": "Code: Prepare Video for Telegram"
    },
    {
      "parameters": {
        "url": "http://vllm_server:8000/v1/models",
        "options": {
          "response": {},
          "timeout": 10000
        }
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.3,
      "position": [
        13232,
        4400
      ],
      "id": "a3f0d1dc-efed-48cb-8261-d12b4c8253a5",
      "name": "HTTP Request: Get Models"
    },
    {
      "parameters": {
        "jsCode": "// –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏ –∏–∑ —Å–ø–∏—Å–∫–∞ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –∏ –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∑–∞–ø—Ä–æ—Å–∞\ntry {\n  const modelsResponse = $input.first().json;\n  const previousItem = $('Code: Prepare LLM Request').first().json;\n  \n  let modelName = 'Qwen/Qwen2.5-7B-Instruct'; // –ú–æ–¥–µ–ª—å –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é\n  \n  // –ü—ã—Ç–∞–µ–º—Å—è –ø–æ–ª—É—á–∏—Ç—å –º–æ–¥–µ–ª—å –∏–∑ –æ—Ç–≤–µ—Ç–∞ —Å–µ—Ä–≤–µ—Ä–∞\n  if (modelsResponse && modelsResponse.data && modelsResponse.data.length > 0) {\n    // vLLM –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–ø–∏—Å–æ–∫ –º–æ–¥–µ–ª–µ–π –≤ —Ñ–æ—Ä–º–∞—Ç–µ { data: [{ id: 'model-name' }] }\n    modelName = modelsResponse.data[0].id;\n    console.log('‚úÖ –ù–∞–π–¥–µ–Ω–∞ –º–æ–¥–µ–ª—å –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ:', modelName);\n  } else if (modelsResponse && modelsResponse.model) {\n    // –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –æ—Ç–≤–µ—Ç–∞\n    modelName = modelsResponse.model;\n    console.log('‚úÖ –ú–æ–¥–µ–ª—å –∏–∑ –æ—Ç–≤–µ—Ç–∞:', modelName);\n  } else {\n    console.log('‚ö†Ô∏è –ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–ª—É—á–∏—Ç—å –º–æ–¥–µ–ª—å —Å —Å–µ—Ä–≤–µ—Ä–∞, –∏—Å–ø–æ–ª—å–∑—É–µ–º –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é:', modelName);\n  }\n  \n  const srtContent = previousItem.srtContent;\n  \n  // –§–æ—Ä–º–∏—Ä—É–µ–º –∑–∞–ø—Ä–æ—Å –∫ LLM\n  const llmRequest = {\n    model: modelName,\n    messages: [\n      {\n        role: 'system',\n        content: '–¢—ã –ø–µ—Ä–µ–≤–æ–¥—á–∏–∫ —Å—É–±—Ç–∏—Ç—Ä–æ–≤. –ü–µ—Ä–µ–≤–µ–¥–∏ –∞–Ω–≥–ª–∏–π—Å–∫–∏–µ —Å—É–±—Ç–∏—Ç—Ä—ã –∏–∑ SRT —Ñ–∞–π–ª–∞ –Ω–∞ —Ä—É—Å—Å–∫–∏–π —è–∑—ã–∫, —Å–æ—Ö—Ä–∞–Ω–∏–≤ —Ñ–æ—Ä–º–∞—Ç SRT –∏ –≤—Ä–µ–º–µ–Ω–Ω—ã–µ –º–µ—Ç–∫–∏. –í–µ—Ä–Ω–∏ —Ç–æ–ª—å–∫–æ –ø–µ—Ä–µ–≤–µ–¥–µ–Ω–Ω—ã–π SRT –∫–æ–Ω—Ç–µ–Ω—Ç –±–µ–∑ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –æ–±—ä—è—Å–Ω–µ–Ω–∏–π.'\n      },\n      {\n        role: 'user',\n        content: srtContent\n      }\n    ],\n    temperature: 0.3,\n    max_tokens: 4000\n  };\n  \n  return [{\n    json: {\n      ...previousItem,\n      llmRequest: llmRequest,\n      modelName: modelName,\n      availableModels: modelsResponse.data || []\n    },\n    binary: $('Code: Prepare LLM Request').first().binary\n  }];\n  \n} catch (error) {\n  console.error('‚ùå –û—à–∏–±–∫–∞ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –º–æ–¥–µ–ª–∏:', error);\n  // Fallback –Ω–∞ –º–æ–¥–µ–ª—å –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é\n  const previousItem = $('Code: Prepare LLM Request').first().json;\n  const modelName = 'Qwen/Qwen2.5-7B-Instruct';\n  \n  const llmRequest = {\n    model: modelName,\n    messages: [\n      {\n        role: 'system',\n        content: '–¢—ã –ø–µ—Ä–µ–≤–æ–¥—á–∏–∫ —Å—É–±—Ç–∏—Ç—Ä–æ–≤. –ü–µ—Ä–µ–≤–µ–¥–∏ –∞–Ω–≥–ª–∏–π—Å–∫–∏–µ —Å—É–±—Ç–∏—Ç—Ä—ã –∏–∑ SRT —Ñ–∞–π–ª–∞ –Ω–∞ —Ä—É—Å—Å–∫–∏–π —è–∑—ã–∫, —Å–æ—Ö—Ä–∞–Ω–∏–≤ —Ñ–æ—Ä–º–∞—Ç SRT –∏ –≤—Ä–µ–º–µ–Ω–Ω—ã–µ –º–µ—Ç–∫–∏. –í–µ—Ä–Ω–∏ —Ç–æ–ª—å–∫–æ –ø–µ—Ä–µ–≤–µ–¥–µ–Ω–Ω—ã–π SRT –∫–æ–Ω—Ç–µ–Ω—Ç –±–µ–∑ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –æ–±—ä—è—Å–Ω–µ–Ω–∏–π.'\n      },\n      {\n        role: 'user',\n        content: previousItem.srtContent\n      }\n    ],\n    temperature: 0.3,\n    max_tokens: 4000\n  };\n  \n  return [{\n    json: {\n      ...previousItem,\n      llmRequest: llmRequest,\n      modelName: modelName\n    },\n    binary: $('Code: Prepare LLM Request').first().binary\n  }];\n}"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        13392,
        4400
      ],
      "id": "2286c9d1-dab2-463f-8113-4c3e1d93d705",
      "name": "Code: Determine Model"
    }
  ],
  "pinData": {},
  "connections": {
    "Schedule Trigger": {
      "main": [
        [
          {
            "node": "HTTP Request",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "HTTP Request": {
      "main": [
        [
          {
            "node": "If",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "If": {
      "main": [
        [
          {
            "node": "Code in JavaScript3",
            "type": "main",
            "index": 0
          },
          {
            "node": "Edit Fields",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Edit Fields": {
      "main": [
        [
          {
            "node": "Code in JavaScript",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Switch": {
      "main": [
        [
          {
            "node": "Get a file",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Code in JavaScript1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code in JavaScript": {
      "main": [
        [
          {
            "node": "Switch",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code in JavaScript1": {
      "main": [
        [
          {
            "node": "HTTP Request2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "HTTP Request2": {
      "main": [
        [
          {
            "node": "Code in JavaScript2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code in JavaScript2": {
      "main": [
        [
          {
            "node": "HTTP Request3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "HTTP Request3": {
      "main": [
        [
          {
            "node": "HTTP Request4",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "HTTP Request4": {
      "main": [
        [
          {
            "node": "Code: Prepare SRT for Translation",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code: Prepare SRT for Translation": {
      "main": [
        [
          {
            "node": "Code: Prepare LLM Request",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code: Prepare LLM Request": {
      "main": [
        [
          {
            "node": "HTTP Request: Get Models",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "HTTP Request5: Translate SRT": {
      "main": [
        [
          {
            "node": "Code: Convert LLM Response to SRT",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code: Convert LLM Response to SRT": {
      "main": [
        [
          {
            "node": "Code: Preserve Original Video",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code: Preserve Original Video": {
      "main": [
        [
          {
            "node": "HTTP Request6",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "HTTP Request: Get Models": {
      "main": [
        [
          {
            "node": "Code: Determine Model",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code: Determine Model": {
      "main": [
        [
          {
            "node": "HTTP Request5: Translate SRT",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "HTTP Request6": {
      "main": [
        [
          {
            "node": "Code: Prepare Video for Telegram",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code: Prepare Video for Telegram": {
      "main": [
        [
          {
            "node": "Send a video",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get a file": {
      "main": [
        [
          {
            "node": "HTTP Request3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code in JavaScript3": {
      "main": [
        [
          {
            "node": "Edit Fields",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "active": false,
  "settings": {
    "executionOrder": "v1"
  },
  "versionId": "445df4fb-2cab-4eb1-af2c-3f10fcd02df7",
  "meta": {
    "templateCredsSetupCompleted": true,
    "instanceId": "4e8499e5babf3d9b81ad21f4dec6219ff84e30a755d4c94f68c1065f8c86af0c"
  },
  "id": "7SFxJqVNnIa9pzGV",
  "tags": []
}